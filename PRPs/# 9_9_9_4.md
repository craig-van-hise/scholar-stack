


# PRP: Robust Taxonomy & Heuristic Data Cleaning

**Context:**
The taxonomy engine currently suffers from two issues:

1. **Low-Quality Input:** Some papers have placeholder descriptions (e.g., "n/a", "no abstract", or short copyright notices) which confuse the categorization.
2. **Formatting Artifacts:** The LLM sometimes outputs verbose names or includes punctuation (like brackets) that get chopped awkwardly.

**Objective:**
Improve data hygiene and category naming using **agnostic heuristics** and **stricter prompt instructions**, avoiding any hard-coded phrases or language-specific rules.

**Target File:** `src/2_cluster_taxonomy.py`

## ðŸ› ï¸ Engineering Requirements

### 1. Heuristic Data Filter (The "Garbage" Fix)

In `cluster_and_categorize`, inside the loop where `papers_payload` is built:

* **Problem:** We cannot trust that every paper has a valid abstract.
* **Agnostic Solution:** Implement a **Length Check**.
* Check if the `description` string is shorter than **50 characters**.
* **Logic:** A valid academic abstract is virtually always >50 chars. Anything less is likely metadata noise, regardless of the language or source.
* **Action:** If `< 50` chars, overwrite `description` with: `f"Title: {row['Title']}"`. This forces the LLM to categorize based on the Title alone, which is safer than a broken abstract.



### 2. Prompt Refinement (The Formatting Fix)

Update the `prompt` string in the "Logic for Large Groups" section. Instead of asking for arbitrary categories, enforce a **Style Guide**:

* **Instruction:** Add: *"Format category names as concise Noun Phrases (e.g., 'Spatial Audio', not 'Papers about Spatial Audio'). Avoid parenthetical qualifiers."*
* **Constraint:** Keep the "Max 3-4 Words" instruction, as this is a structural constraint, not a content one.

### 3. Agnostic String Cleaning

Update the category cleaning block to be purely syntactic:

* **Import:** Ensure `string` is imported (`import string`).
* **Logic:** Remove the complex regex that targets specific words like "and".
* **Replacement:** Use Python's standard library to strip trailing punctuation/whitespace.
```python
# 1. Trust the LLM's output (constrained by prompt)
cat_raw = item['category_name'].strip()

# 2. Safety Truncate (Generous buffer for long technical terms)
# If > 6 words, it's likely a sentence, so we chop it.
words = cat_raw.split()
if len(words) > 6:
    cat_raw = " ".join(words[:6])

# 3. Universal Cleanup
# Strips any trailing punctuation (brackets, commas, dashes, etc.) from ANY language.
cat_clean = cat_raw.strip(string.punctuation + string.whitespace)

local_map[item['id']] = cat_clean

```



## âœ… Definition of Done

1. **Universal Logic:** The code contains no hard-coded blacklists (no `"International audience"`, no `"and/or/the"`).
2. **Data Safety:** Short/Empty descriptions are automatically handled by the length heuristic.
3. **Clean Output:** Category names are free of trailing punctuation artifacts (e.g., `Category Name,` becomes `Category Name`).